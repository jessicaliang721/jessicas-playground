<div class="row related-posts">
	<div class="col">
		<h3 class="text-center">Related Posts</h3>
		{% assign maxRelated = 3 %}
		{% assign minCommonTags =  1 %}
		{% assign maxRelatedCounter = 0 %}
		<div class="row">
			{% for post in site.posts %}
				{% assign sameTagCount = 0 %}
				{% for tag in post.tags %}
					{% if post.url != page.url %}
						{% if page.tags contains tag %}
							{% assign sameTagCount = sameTagCount | plus: 1 %}
						{% endif %}
					{% endif %}
				{% endfor %}

				{% if sameTagCount >= minCommonTags %}
					<div class="col-md-4">
						<div class="card">
							<a href="{{ post.url | relative_url }}">
								{% if post.image %}
								<img class="img-thumbnail" src="{{ post.image }}" alt="{{ post.title }}">
								{% else %}
								<img class="img-thumbnail"
								     src="{{ site.baseurl }}/assets/images/category_icons/{{ post.category }}.png"
								     alt="{{ post.title }}">
								{% endif %}
							</a>
							<div class="card-body">
								<a href="{{ post.url | relative_url }}"><h5 class="card-title">{{ post.title }}</h5></a>
								<p>{{ post.date | date_to_long_string }}</p>
							</div>
						</div>
					</div>
					{% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
					{% if maxRelatedCounter >= maxRelated %}
						{% break %}
					{% endif %}
				{% endif %}
			{% endfor %}
		</div>
	</div>
</div>